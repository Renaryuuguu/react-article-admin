import{b as f,j as e}from"../entry/index-poDKF_yo.js";import{u as h,s as v}from"./user-store-GXeePqgB.js";import{u as A}from"./user-api-cqZYb3fC.js";import{u as g}from"./hooks-PobqOnIT.js";import"./index-94wIOjEc.js";const w=()=>{const a=h(v),r=React.useRef(null),[t,u]=React.useState(""),l=React.useMemo(()=>!t||t===a,[t,a]),d=f(),o=g("PATCH"),c=()=>{var s;(s=r.current)==null||s.click()},m=s=>{const i=s.currentTarget.files;if(!i||i.length===0)return;const n=new FileReader;n.readAsDataURL(i[0]),n.onload=()=>{n.result&&u(n.result)}},p=()=>{o||d({avatar:t},{method:"PATCH"})};return e.jsxs(antd.Space,{direction:"vertical",children:[t||a?e.jsx(antd.Avatar,{src:t||a,size:300,shape:"square"}):e.jsx(antd.Avatar,{size:300,shape:"square",onClick:c,children:"请选择头像"}),e.jsxs(antd.Space,{direction:"horizontal",children:[e.jsx(antd.Button,{onClick:c,children:"选择头像"}),e.jsx(antd.Button,{type:"primary",disabled:l,onClick:p,loading:o&&{delay:200},children:"保存头像"}),e.jsx("input",{type:"file",accept:"image/*",ref:r,onChange:m,hidden:!0})]})]})},y=async({request:a})=>{const r=await a.formData();try{await A(r)}catch{return null}return antd.message.success("头像更新成功"),null};export{y as action,w as default};
