import{b as u,W as c,j as e,B as d}from"../entry/index-HYVjuyXu.js";import{c as w}from"./user-api-kpygNglZ.js";import{u as f}from"./hooks-6wdiGh58.js";import{u as j,F as t,I as n}from"./index-vkfpJKNu.js";import{S as x}from"./index-U1XM-2_3.js";import{S as h}from"./index-FvAIaAj1.js";import{s as y}from"./index-Ofe16QpN.js";import"./EyeOutlined-9LXoceyI.js";import"./collapse-as1LdTNY.js";const A=()=>{const i=u(),[r]=j(),a=c(),m=f("PATCH");a!=null&&a.result&&r.resetFields();const l=s=>{m||i(s,{method:"PATCH"})};return e.jsx(t,{style:{maxWidth:600},labelCol:{span:4},wrapperCol:{span:16},onFinish:l,form:r,children:e.jsxs(x,{spinning:m,delay:200,children:[e.jsx(t.Item,{label:"原密码",name:"old_pwd",rules:[{required:!0,message:"请输入原密码"},{pattern:/^\S{6,15}$/,message:"密码长度为6-15位"}],validateFirst:!0,children:e.jsx(n,{type:"password"})}),e.jsx(t.Item,{label:"新密码",name:"new_pwd",dependencies:["old_pwd"],rules:[{required:!0,message:"请输入新密码"},{pattern:/^\S{6,15}$/,message:"密码长度为6-15位"},({getFieldValue:s})=>({validator(p,o){return o===s("old_pwd")?Promise.reject(new Error("新密码不能与原密码相同")):Promise.resolve()}})],validateFirst:!0,children:e.jsx(n,{type:"password"})}),e.jsx(t.Item,{label:"确认密码",name:"re_pwd",dependencies:["new_pwd"],rules:[{required:!0,message:"请确认密码"},{pattern:/^\S{6,15}$/,message:"密码长度为6-15位"},({getFieldValue:s})=>({validator(p,o){return o!==s("new_pwd")?Promise.reject(new Error("两次密码输入不一致")):Promise.resolve()}})],validateFirst:!0,children:e.jsx(n,{type:"password"})}),e.jsx(t.Item,{wrapperCol:{offset:4},children:e.jsxs(h,{children:[e.jsx(d,{type:"primary",htmlType:"submit",children:"保存"}),e.jsx(d,{type:"default",onClick:()=>r.resetFields(),children:"重置"})]})})]})})},q=async({request:i})=>{const r=await i.formData();try{await w(r)}catch{return null}return y.success("密码修改成功"),{result:!0}};export{q as action,A as default};
